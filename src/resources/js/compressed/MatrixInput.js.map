{"version":3,"file":"MatrixInput.js","sources":["../MatrixInput.js"],"names":["$","Craft","MatrixInput","Garnish","Base","extend","id","blockTypes","blockTypesByHandle","inputNamePrefix","inputIdPrefix","maxBlocks","showingAddBlockMenu","addBlockBtnGroupWidth","addBlockBtnContainerWidth","$container","$blockContainer","$addBlockBtnContainer","$addBlockBtnGroup","$addBlockBtnGroupBtns","blockSort","blockSelect","totalNewBlocks","init","this","formatInputId","children","$addBlockMenuBtn","setNewBlockBtn","i","length","blockType","handle","$blocks","collapsedBlocks","getCollapsedBlockIds","DragSort","axis","filter","proxy","$targetItem","hasClass","getSelectedItems","collapseDraggees","magnetStrength","helperLagBase","helperOpacity","onSortChange","resetItemOrder","Select","multi","vertical","checkboxMode","$block","data","newMatch","match","parseInt","block","MatrixBlock","inArray","collapse","addListener","ev","type","target","addBlock","MenuBtn","onOptionSelect","option","updateAddBlockBtn","width","addClass","removeClass","canAddMoreBlocks","$insertBefore","html","getBlockTypeByHandle","name","t","insertBefore","appendTo","$fieldsContainer","bodyHtml","getParsedBlockHtml","footHtml","css","getHiddenBlockCss","velocity","opacity","margin-bottom","$bod","append","initUiElements","addItems","requestAnimationFrame","scrollContainerToElement","collapseSelectedBlocks","callOnSelectedBlocks","expandSelectedBlocks","disableSelectedBlocks","enableSelectedBlocks","deleteSelectedBlocks","fn","$selectedItems","eq","marginBottom","outerHeight","replace","collapsedBlockStorageKey","siteUid","localStorage","filterArray","split","setCollapsedBlockIds","ids","join","rememberCollapsedBlockId","Storage","push","forgetCollapsedBlockId","collapsedBlocksIndex","splice","matrix","$titlebar","$previewContainer","$actionMenu","$collapsedInput","isNew","collapsed","substr","$menuBtn","find","menuBtn","menu","settings","hasAttr","preventDefault","toggle","expand","animate","previewHtml","$fields","$field","$inputs","inputPreviewText","j","value","$input","$maybeLightswitchContainer","parent","text","getText","getInputPostVal","Array","trim","duration","height","show","hide","setTimeout","val","collapsedContainerHeight","expandedContainerHeight","disable","enable","onMenuOptionSelect","batchAction","totalSelected","isSelected","$option","confirm","selfDestruct","remove","jQuery"],"mappings":"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"}