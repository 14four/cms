{"version":3,"file":"MatrixInput.js","sources":["../MatrixInput.js"],"names":["$","Craft","MatrixInput","Garnish","Base","extend","id","blockTypes","blockTypesByHandle","inputNamePrefix","inputIdPrefix","maxBlocks","showingAddBlockMenu","addBlockBtnGroupWidth","addBlockBtnContainerWidth","$container","$blockContainer","$addBlockBtnContainer","$addBlockBtnGroup","$addBlockBtnGroupBtns","blockSort","blockSelect","totalNewBlocks","init","this","formatInputId","children","$addBlockMenuBtn","setNewBlockBtn","i","length","blockType","handle","$blocks","collapsedBlocks","getCollapsedBlockIds","DragSort","axis","filter","proxy","$targetItem","hasClass","getSelectedItems","collapseDraggees","magnetStrength","helperLagBase","helperOpacity","onSortChange","resetItemOrder","Select","multi","vertical","checkboxMode","$block","data","newMatch","match","parseInt","block","MatrixBlock","inArray","collapse","addListener","ev","type","target","addBlock","MenuBtn","onOptionSelect","option","updateAddBlockBtn","width","addClass","removeClass","canAddMoreBlocks","$insertBefore","html","getBlockTypeByHandle","name","t","insertBefore","appendTo","$fieldsContainer","bodyHtml","getParsedBlockHtml","footHtml","css","getHiddenBlockCss","velocity","opacity","margin-bottom","$bod","append","initUiElements","addItems","collapseSelectedBlocks","callOnSelectedBlocks","expandSelectedBlocks","disableSelectedBlocks","enableSelectedBlocks","deleteSelectedBlocks","fn","$selectedItems","eq","marginBottom","outerHeight","replace","collapsedBlockStorageKey","siteUid","localStorage","filterArray","split","setCollapsedBlockIds","ids","join","rememberCollapsedBlockId","Storage","push","forgetCollapsedBlockId","collapsedBlocksIndex","splice","matrix","$titlebar","$previewContainer","$actionMenu","$collapsedInput","isNew","collapsed","substr","$menuBtn","find","menuBtn","menu","settings","hasAttr","preventDefault","toggle","expand","animate","previewHtml","$fields","$field","$inputs","inputPreviewText","j","value","$input","$maybeLightswitchContainer","parent","text","getText","getInputPostVal","Array","trim","duration","height","show","hide","setTimeout","val","collapsedContainerHeight","expandedContainerHeight","disable","enable","onMenuOptionSelect","batchAction","totalSelected","isSelected","$option","confirm","selfDestruct","remove","jQuery"],"mappings":"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"}