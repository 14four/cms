{% import "_includes/forms" as forms %}

{% if sources %}

	{{
		forms.checkboxField({
		label: "Restrict to a single folder?"|t,
		id: 'useSourcePath-toggle',
		name: 'useSourcePath',
		class: 'use-source-path-cb',
		value: 1,
		checked: settings.sourcePath
	}) }}

	<div class="source-selection">
		{% if allowMultipleSources %}
			{{ forms.checkboxSelectField({
				label: "Sources"|t,
				instructions: "Which sources do you want to select {type} from?"|t({ type: type|lower }),
				id: 'sources',
				name: 'sources',
				options: sources,
				values: settings.sources
			})}}
		{% else %}
			{{ forms.selectField({
				label: "Source"|t,
				instructions: "Which source do you want to select {type} from?"|t({ type: type|lower }),
				id: 'source',
				name: 'source',
				options: sources,
				value: settings.source
			}) }}
		{% endif %}
	</div>

	<div class="single-folder">
		{{ forms.textField({
			label: "Single folder path"|t,
			instructions: "Must start with {folder:x} or {source:x}."|t({ type: type|lower }),
			id: 'sourcePath',
			name: 'sourcePath',
			value: settings.sourcePath,
			errors: settings.getErrors('sourcePath')
		}) }}
	</div>

	{% set js %}
		displayAssetSettings = function (elem)
		{
			if (elem.prop('checked'))
			{
				$('.source-selection').hide();
				$('.single-folder').show();
			}
			else
			{
				$('.source-selection').show();
				$('.single-folder').hide();
			}
		};

		var element = $('.use-source-path-cb');
		element.on('click', function (ev) {
			displayAssetSettings($(ev.currentTarget));
 		});
		displayAssetSettings(element);

	{% endset %}

	{% includeJs js %}
{% else %}
	{{ forms.field({
		label: (allowMultipleSources ? "Sources"|t : "Source"|t)
	}, '<p class="error">' ~ "No sources exist yet."|t ~ '</p>') }}
{% endif %}

{% if allowLimit %}
	{{ forms.textField({
		label: "Limit"|t,
		instructions: "Limit the number of selectable {type}."|t({ type: type|lower }),
		id: 'limit',
		name: 'limit',
		value: settings.limit,
		size: 2,
		errors: settings.getErrors('limit')
	}) }}
{% endif %}

