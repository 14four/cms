{% import "_includes/forms" as forms %}

<h2>{{ 'Migrations'|t('app') }}</h2>

{% if newMigrations|length > 0 or migrationHistory|length > 0 %}
	<table class="data fullwidth">
		<thead>
		<tr>
			<th>{{ 'Name'|t('app') }}</th>
			<th>{{ 'Status'|t('app') }}</th>
			<th>{{ 'Apply / Revert'|t('app') }}</th>
			<th>{{ 'Apply this migration and the ones above'|t('app') }}</th>
		</tr>
		</thead>
		<tbody>

			{% for newMigration in newMigrations %}
				<tr>
					<td>{{ newMigration }}</td>
					<td>{{ 'New'|t('app') }}</td>
					<td>
						<a href="{{ actionUrl('utilities/content-migration-manager-migrate-up', {
							name: newMigration
						}) }}">{{ 'Apply Migration'|t('app') }}</a>
					</td>
					<td>
						{% if not loop.first %}
							<a href="{{ actionUrl('utilities/content-migration-manager-up', {
								limit: loop.index
							}) }}">{{ 'Apply this migration and the ones above'|t('app') }}</a>
						{% endif %}
					</td>
				</tr>
			{% endfor %}

			{% for migrationName, migration in migrationHistory %}
				<tr>
					<td>{{ migrationName }}</td>
					<td>{{ 'Applied'|t('app') }}</td>
					<td>
						<a href="{{ actionUrl('utilities/content-migration-manager-migrate-down', {
							name: migrationName
						}) }}">{{ 'Revert Migration'|t('app') }}</a>
					</td>
					<td>
						{% if not loop.first %}
							<a href="{{ actionUrl('utilities/content-migration-manager-down', {
								limit: loop.index
							}) }}">{{ 'Revert this migration and the ones above'|t('app') }}</a>
						{% endif %}
					</td>
				</tr>
			{% endfor %}
		</tbody>
	</table>

	<div class="buttons">
		<a href="{{ actionUrl('utilities/content-migration-manager-up') }}" class="btn submit">{{ 'Apply All Migrations'|t('app') }}</a>
	</div>
{% else %}
	<p>{{ 'No migrations.'|t('app') }}</p>
{% endif %}