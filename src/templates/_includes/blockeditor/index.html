<div class="blockeditor" data-input-name="{{ name }}">

	<div class="list">
		<h3>{{ "Content Blocks"|t }}</h3>
		<ul>
			{% for block in currentBlocks %}
				<li><a class="block-item {% if block.errors %}error{% endif %}" data-block-id="{{ block.id }}">
					<div class="name {% if block.required %}required{% endif %}">{% if block.name %}{{ block.name }}{% else %}Untitled{% endif %}</div>
					<div class="type">{{ block.blocktypeName }}</div>
					<input type="hidden" name="{{ name }}[order][]" value="{{ block.id }}">
				</a></li>
			{% endfor %}
		</ul>
		<a class="btn addbtn new-block">{{ "New content block"|t }}</a>
	</div>

	<div class="settings">
		{% for block in currentBlocks %}
			<div data-block-id="{{ block.id }}" style="display:none">
				{% include "_includes/blockeditor/blocksettings" with {
					'idPrefix': name ~ "-" ~ block.id ~ "-",
					'namePrefix': name ~ "[" ~ block.id ~ "]",
					'block': block
				} %}
			</div>
		{% endfor %}
	</div>

	{% set newIdPrefix = name ~ "-BLOCK-ID-" %}
	{% set newNamePrefix = name ~ "[BLOCK_ID]" %}

	<div class="freshblocksettings" style="display:none">
		<div class="blockeditor-settings" data-block-id="BLOCK_ID">
			{% include "_includes/blockeditor/blocksettings" with {'idPrefix': newIdPrefix, 'namePrefix': newNamePrefix} %}
		</div>
	</div>

	<div class="freshblocktypesettings" style="display:none">
		{% for blocktype in blx.contentblocks.blocktypes %}
			{% set settings = blocktype.displaySettings(newIdPrefix, newNamePrefix ~ "[settings]") %}
			{% if settings %}
				<div data-blocktype-class="{{ blocktype.classHandle }}">
					<div class="{{ blocktype.classHandle }} nested-pane-items">
						<div></div>
						{{ settings }}
					</div>
				</div>
			{% endif %}
		{% endfor %}
	</div>

</div>
