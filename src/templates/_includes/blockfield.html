{% from "_includes/forms" import field %}
{% if entity is not defined %}{% set entity = null %}{% endif %}

{% set value = (entity ? attribute(entity, block.handle) : null) %}
{% set errors = (entity ? entity.getErrors(block.handle) : null) %}
{% set blockType = blx.blockTypes.populateBlockType(block, entity) %}
{% set input = blockType.getInputHtml(block.handle, value) %}

{{ field({
	label: block.name,
	required: block.required,
	translatable: block.translatable,
	instructions: block.instructions,
	id: block.handle,
	inputClass: blockType.classHandle|lower,
	errors: errors
}, input)|ns('blocks')|raw }}
