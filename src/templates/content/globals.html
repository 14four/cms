{% extends "content/_layout" %}
{% set selectedTab = 'globals' %}


{% set globalSets = craft.globals.getEditableSets('handle') %}

{% if globalSetHandle is defined %}
	{% if globalSetHandle not in globalSets|keys %}
		{% exit 404 %}
	{% endif %}
{% elseif globalSets|length %}
	{% set globalSetHandle = globalSets|keys[0] %}
{% endif %}


{% if globalSet is not defined %}
	{% set globalSet = globalSets[globalSetHandle] %}
{% endif %}


{% if globalSets|length %}
	{% set sidebar %}
		<nav>
			<ul>
				{% for theGlobalSet in globalSets %}
					<li><a{% if theGlobalSet.handle == globalSetHandle %} class="sel"{% endif %} href="{{ url('content/globals/'~theGlobalSet.handle) }}">{{ theGlobalSet.name|t }}</a></li>
				{% endfor %}
			</ul>
		</nav>
	{% endset %}

	{% set content %}
		<form method="post" action="" accept-charset="UTF-8">
			<input type="hidden" name="action" value="globals/saveContent">
			<input type="hidden" name="setId" value="{{ globalSet.id }}">

			<div>
				{% include "_includes/fields" with {
				    fields: globalSet.getFieldLayout().getFields(),
				    entry: globalSet
				} only %}
			</div>

			<div class="buttons">
				<input type="submit" class="btn submit" value="{{ 'Save'|t }}">
			</div>
		</form>
	{% endset %}
{% else %}
	{% set content %}
		<p class="centeralign">
			{{ "No global sets exist yet."|t }}
			{% if user.admin %}
				<a class="go" href="{{ url('settings/globals/new') }}">{{ "Create the first one"|t }}</a>
			{% endif %}
		</p>
	{% endset %}
{% endif %}
