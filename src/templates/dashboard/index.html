{% layout '_layouts/full' %}

{% region pageTitle %}Dashboard{% /region %}
{% region styles %}{{ cp.resource('app/styles/dashboard.css').css }}{% /region %}

{% region main %}
	<div id="alerts">
		{% if !blocks.config.licenseKeys %}
			<div class="alert">
				<p>You need to enter your license key into {{ blocks.config.configPath }}. <a href="">See how</a></p>
			</div>
		{% /if %}

		{% foreach cp.dashboard.alerts as alert %}
			<div class="alert">
				<p>{{ alert }}</p>
			</div>
		{% /foreach %}
	</div>

	<div id="dashboard">
		<a id="sidebar-btn" class="settings-btn" title="Customize"></a>

		<div id="widgets">
			{% foreach cp.dashboard.widgets as widget %}
				{% if widget.body %}
					<div id="widget{{ widget.id }}" class="pane widget {{ widget.classname }}">
						<div class="head">
							{% if widget.settings %}
								<a class="settings-btn" title="Settings"></a>
							{% /if %}
							<h3>{{ widget.title }}</h3>
						</div>
						{% if widget.settings %}
							<div class="settings-outer-container"><div class="settings-inner-container">
								<div class="settings">
									{{ widget.settings }}
									<div class="buttons">
										<a class="btn submit"><span class="label">Save</span></a>
										<a class="btn cancel"><span class="label">Cancel</span></a>
									</div>
								</div>
							</div></div>
						{% /if %}
						<div class="body">
							{{ widget.body }}
						</div>
					</div>
				{% /if %}
			{% /foreach %}
		</div>

		<div id="dashboard-sidebar" class="sidebar">
			<div class="pane">
				<div class="head">
					<h6>Widget Order</h6>
				</div>
				<div class="body">
					<ul class="widget-handles">
						{% foreach cp.dashboard.widgets as widget %}
						<li class="item {% if !widget.body %}hidden{% /if %}" data-widget-id="widget{{ widget.id }}">
							<span class="grab"></span><span class="title">{{ widget.title }}</span><a class="remove" title="Remove"></a>
						</li>
						{% /foreach %}
					</ul>
				</div>
			</div>
		</div>
	</div>
{% /region %}

{% region scripts %}
	{% if !cp.updateInfoCached %}
		<script type="text/javascript">window.getAlerts = true;</script>
	{% /if %}

	{{ cp.resource('app/scripts/ui/Drag.js').js }}
	{{ cp.resource('app/scripts/ui/DragSort.js').js }}
	{{ cp.resource('app/scripts/dashboard.js').js }}
{% /region %}
