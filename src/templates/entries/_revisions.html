{% requireEdition CraftClient %}

{% set drafts = craft.entryRevisions.getEditableDraftsByEntryId(entry.id, entry.locale) %}
{% set versions = craft.entryRevisions.getVersionsByEntryId(entry.id, entry.locale) %}
{% set baseUrl = 'entries/'~entry.getSection().handle~'/'~entry.id~'/' %}

<div id="revision-btn" class="btn menubtn">{{ revisionLabel }}</div>

<div class="menu padded">
	<ul>
		<li><a{% if entry.getClassHandle() == 'Entry' %} class="sel"{% endif %} href="{{ entry.cpEditUrl }}">{{ "Current"|t }}</a></li>
	</ul>

	{% if drafts %}
		<hr>
		<h6>{{ "Drafts"|t }}</h6>
		<ul>
			{% for draft in drafts %}
				<li><a{% if entry.getClassHandle() == 'EntryDraft' and draft.draftId == draftId %} class="sel"{% endif %} href="{{ url(baseUrl~'drafts/'~draft.draftId) }}">
					{{ draft.name }}
					<span class="light">{{ draft.creator }}</span>
				</a></li>
			{% endfor %}
		</ul>
	{% endif %}

	{% if versions %}
		<hr>
		<h6>{{ "Past Versions"|t }}</h6>
		<ul>
			{% for version in versions %}
				<li><a{% if entry.getClassHandle() == 'EntryVersion' and version.versionId == versionId %} class="sel"{% endif %} href="{{ url(baseUrl~'versions/'~version.versionId) }}">
					{{ "Version {id}"|t({ id: version.versionId }) }}
					<span class="light">{{ version.creator }}</span>
				</a></li>
			{% endfor %}
		</ul>
	{% endif %}
</div>

{% if entry.getClassHandle() == 'EntryDraft' %}
	<a id="editdraft-btn" class="btn edit icon" title="{{ 'Edit Draft Settings'|t }}"></a>
	{% includeJsResource 'js/EntryDraftEditor.js' %}
	{% includeJs 'new Craft.EntryDraftEditor('~entry.draftId~', "'~revisionLabel|e('js')~'");' %}
{% endif %}
