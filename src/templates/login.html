{% if blx.session.loggedin %}
	{# redirect "dashboard" #}
{% endif %}


{% set title = "Login" %}
{% extends "_layouts/basic" %}


{% block styles %}
	{% include "_includes/css_include" with {'file': 'styles/login.css'} %}
{% endblock %}


{% block body %}
	<script type="text/javascript">
		var cookie = 'BlocksCookieTest='+Math.floor(Math.random() * 1000000);
		document.cookie = cookie;
		var cookiesEnabled = document.cookie.search(cookie) != -1;
		if (cookiesEnabled)
		{
			document.write(
				'<form id="login-form" method="post" action="">' +
					'<div id="login-pane" class="main">' +
						'<div class="field">' +
							'<div class="heading">' +
								'<label for="username">Username or email</label>' +
							'</div>' +
							'<div class="textwrapper"><input id="username" class="text" type="text" value="{{ blx.session.rememberedusername }}"></div>' +
						'</div>' +
						'<div id="password-container" class="nested-fields">' +
							'<div class="field">' +
								'<div class="heading">' +
									'<label for="password">Password</label>' +
									' <p><a id="forgot-password">Forget?</a></p>' +
								'</div>' +
								'<div class="passwordwrapper"><input id="password" class="text password" type="password"></div>' +
							'</div>' +
						'</div>' +

						'<div class="buttons">' +
							'<input id="login-btn" class="btn big submit disabled" type="submit" value="Login">' +

							'<label id="remember-me-label" class="checkbox">' +
								'<div class="cbwrapper"><input type="checkbox" id="remember-me"></div>' +
								'Remember me' +
							'</label>' +
						'</div>' +

						{% if not blx.request.secure %}
							'<a id="insecure" title="This is an insecure connection." data-icon="i"></a>' +
						{% endif %}

					'</div>' +
				'</form>'
			);

			var id = {% if blx.session.rememberedusername %}'password'{% else %}'username'{% endif %};
			document.getElementById(id).focus();
		}
		else
		{
			document.write(
				'<div class="no-access">' +
					'<div class="pane">' +
						'<div class="pane-body">' +
							'<div class="notice">' +
								'<div class="icon"></div>' +
								'<p>Cookies must be enabled to access the Blocks CP.<br>' +
									'<a class="go" href="">See how</a>' +
								'</p>' +
							'</div>' +
						'</div>' +
					'</div>' +
				'</div>'
			);
		}
	</script>
{% endblock %}


{% block scripts %}
	{% include "_includes/js_include" with {'file': 'login.js'} %}
{% endblock %}
