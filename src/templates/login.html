{if b.session.loggedin}
	{redirect "dashboard"}
{/if}

{layout "_layouts/basic" pageTitle="Login"}

{region "styles"}
	{include "_includes/css_include" file="styles/login.css"}
{/region}

{region "body"}
	<script type="text/javascript">
		var cookie = 'BlocksCookieTest='+Math.floor(Math.random() * 1000000);
		document.cookie = cookie;
		var cookiesEnabled = document.cookie.search(cookie) != -1;
		if (cookiesEnabled)
		{
			document.write(
				'<form id="login-form" method="post" action="">' +
					'<div id="login-pane" class="main">' +
						'<div class="field">' +
							'<div class="heading">' +
								'<label for="username">Username or Email</label>' +
							'</div>' +
							'<div class="textwrapper"><input id="username" class="text" type="text" value="{:b.session.rememberedusername}" /></div>' +
						'</div>' +
						'<div id="password-container" class="nested-fields">' +
							'<div class="field">' +
								'<div class="heading">' +
									'<label for="password">Password</label>' +
									' <p><a id="forgot-password">Forget?</a></p>' +
								'</div>' +
								'<div class="passwordwrapper"><input id="password" class="text password" type="password" /></div>' +
							'</div>' +
						'</div>' +

						'<div class="buttons">' +
							'<input id="login-btn" class="btn big submit disabled" type="submit" value="Login" />' +

							'<label id="remember-me-label" class="checkbox">' +
								'<div class="cbwrapper"><input type="checkbox" id="remember-me" /></div>' +
								'Remember me' +
							'</label>' +
						'</div>' +

						{if !b.request.secure}
							'<a id="insecure" title="This is an insecure connection." data-icon="i"></a>' +
						{/if}

					'</div>' +
				'</form>'
			);

			var id = {if b.session.rememberedusername}'password'{else}'username'{/if};
			document.getElementById(id).focus();
		}
		else
		{
			document.write(
				'<div class="no-access">' +
					'<div class="pane">' +
						'<div class="pane-body">' +
							'<div class="notice">' +
								'<div class="icon"></div>' +
								'<p>Cookies must be enabled to access the Blocks CP.<br>' +
									'<a class="go" href="">See how</a>' +
								'</p>' +
							'</div>' +
						'</div>' +
					'</div>' +
				'</div>'
			);
		}
	</script>
{/region}

{region "scripts"}
	{include "_includes/js_include" file="login.js"}
{/region}
