{% if blx.session.loggedin %}
	{% redirect "dashboard" %}
{% endif %}


{% extends "_layouts/basic" %}
{% set title = "Login"|t %}
{% include_css "login.css" %}
{% include_js "login.js" %}
{% include_translation
	"Reset Password",
	"Weâ€™ve sent you an email with instructions to reset your password.",
	"An unknown error occurred."
%}


{% block body %}
	<script type="text/javascript">
		var cookie = 'BlocksCookieTest='+Math.floor(Math.random() * 1000000);
		document.cookie = cookie;
		var cookiesEnabled = document.cookie.search(cookie) != -1;
		if (cookiesEnabled)
		{
			document.write(
				'<form id="login-form" method="post" action="">' +
					'<div class="field">' +
						'<div class="textwrapper"><input id="username" class="text nicetext" type="text" data-hint="{{ "Username or Email"|t }}" value="{{ blx.session.rememberedusername }}"></div>' +
					'</div>' +

					'<div id="login-fields" class="nested-fields">' +
						'<div class="field">' +
							{#'<div class="heading">' +
								'<label for="password">{{ "Password"|t }}</label>' +
								' <a id="forgot-password">{{ "forget?"|t }}</a>' +
							'</div>' +#}
							'<div class="passwordwrapper"><input id="password" class="text nicetext password" type="password" data-hint="{{ "Password"|t }}"></div>' +
						'</div>' +

						'<div class="field">' +
							'<label>' +
								'<input type="checkbox" id="remember-me"> ' +
								'{{ "Keep me logged in"|t }}' +
							'</label>' +
						'</div>' +
					'</div>' +

					'<div class="buttons">' +
						'<div id="submit" class="btn submit disabled" data-icon="{{ blx.request.secure ? '`' : '~' }}">' +
							'<span class="label">{{ "Login"|t }}</span>' +
							'<input type="submit">' +
						'</div>' +
						'<div id="spinner" class="spinner" style="display: none;"></div>' +
					'</div>' +
				'</form>'
			);

			var id = {% if blx.session.rememberedusername %}'password'{% else %}'username'{% endif %};
			document.getElementById(id).focus();
		}
		else
		{
			document.write(
				'<div class="no-access">' +
					'<div class="pane">' +
						'<div class="pane-body">' +
							'<div class="notice">' +
								'<div class="icon"></div>' +
								'<p>{{ "Cookies must be enabled to access the Blocks CP."|t }}<br>' +
									'<a class="go" href="">{{ "See how"|t }}</a>' +
								'</p>' +
							'</div>' +
						'</div>' +
					'</div>' +
				'</div>'
			);
		}
	</script>
{% endblock %}
