{if !site && siteId}
	{set site = sites.getSiteById(siteId)}
{/if}

{if site.id}
	{if site.name}
		<?php $pageTitle = new TemplateVariable($site->name().' site settings'); ?>
	{else}
		{set pageTitle = "Untitled site settings"}
	{/if}
{else}
	{set pageTitle = "Create a new site"}
{/if}

{layout "_layouts/cp" pageTitle=pageTitle crumbs="settings:Settings"}


{region "main"}
	<h1>{:pageTitle}</h1>

	<form method="post" action="">
		<input type="hidden" name="action" value="sites/save" />
		<input type="hidden" name="redirect" value="settings/sites" />
		{if site.id}<input type="hidden" name="site_id" value="{:site.id}">{/if}

		<div class="field">
			<div class="heading">
				<label for="name">Site Name</label>
			</div>
			<div class="textwrapper"><input id="name" name="name" class="text" type="text" value="{:site.name}" /></div>
			{if site.errors.name}
				{include "_includes/error_list" errors=site.errors.name}
			{/if}
		</div>
		<div class="field">
			<div class="heading">
				<label for="handle">Site Handle</label>
				<p>How you’ll refer to your site in the templates.
					{if site.id}<br/><strong>Note:</strong> If you change this, you’ll need to rename your site’s template folder to match it.{/if}
				</p>
			</div>
			<div class="textwrapper"><input id="handle" name="handle" class="text code" type="text" value="{:site.handle}" /></div>
			{if site.errors.handle}
				{include "_includes/error_list" errors=site.errors.handle}
			{/if}
		</div>
		<div class="field">
			<div class="heading">
				<label for="url">Site URL</label>
			</div>
			<div class="textwrapper"><input id="url" name="url" class="text" type="text" value="{:site.url}" /></div>
			{if site.errors.url}
				{include "_includes/error_list" errors=site.errors.url}
			{/if}
		</div>
		<div class="field">
			<div class="heading">
				<label for="url">Language</label>
			</div>
			{include "_includes/language" name="language" value=site.language}
		</div>

		<input class="btn big submit" type="submit" value="Save Site" />
	</form>
{/region}


{if !site}
	{region "scripts"}
		<script type="text/javascript">
			new b.ui.HandleGenerator('#name', '#handle');
		</script>
	{/region}
{/if}
