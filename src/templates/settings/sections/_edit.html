{layout "settings/_layouts/settings" pageTitle="Edit Section"}


{if !section}
	{set section = content.getSection(sectionId)}
{/if}


{region "main"}
	{if content.sections}
		<div class="toolbar">
			{include "_includes/back_btn" label="Sections" uri="settings/sections"}
		</div>

		{if section.id}
			<h2>{if section.name}<strong>{:section.name}</strong>{else}Untitled{/if} section settings</h2>
		{else}
			<h2>Create a new section</h2>
		{/if}
	{else}
		<h2>Create the first section</h2>
	{/if}

	<form method="post" action="">
		<input type="hidden" name="action" value="content/saveSection" />
		<input type="hidden" name="redirect" value="settings/sections" />
		{if section.id}<input type="hidden" name="section_id" value="{:section.id}">{/if}
		<div class="pane">
			<div class="pane-body">
				<div class="pane-item field">
					<label class="required" for="name">Section Name</label>
					<div class="input-wrapper"><input id="name" name="name" class="{if section.errors.name}error{/if}" type="text" value="{:section.name}" /></div>
					{if section.errors.name}
						{include "_includes/error_list" errors=section.errors.name}
					{/if}
				</div>
				<div class="pane-item field">
					<label class="required" for="handle">Section Handle</label>
					<p>This is how youâ€™ll refer to your section in the templates.</p>
					<div class="input-wrapper"><input id="handle" name="handle" class="code {if section.errors.handle}error{/if}" type="text" value="{:section.handle}" /></div>
					{if section.errors.handle}
						{include "_includes/error_list" errors=section.errors.handle}
					{/if}
				</div>
				<div class="pane-item field">
					<div class="left">
						<label for="sortable">Can entries be manually sorted?</label>
					</div>
					<div class="right">
						{include "_includes/lightswitch" name="sortable" on=section.sortable}
					</div>
					<div class="clear"></div>
					{if section.errors.sortable}
						{include "_includes/error_list" errors=section.errors.sortable}
					{/if}
				</div>
				<div class="pane-item field">
					<div class="left">
						<label for="has_urls">Do entries have their own URLs?</label>
					</div>
					<div class="right">
						{include "_includes/lightswitch" name="has_urls" on=section.has_urls toggle="#has-urls-setting"}
					</div>
					<div class="clear"></div>
				</div>
				<div id="has-urls-setting" class="nested-pane-items" {if !section.has_urls}style="height: 0"{/if}>
					<div class="pane-item field">
						<label for="url_format">Entry URL Format</label>
						<div class="input-wrapper"><input id="url_format" name="url_format" class="code {if section.errors.url_format}error{/if}" type="text" value="{:section.url_format}" /></div>
					</div>
					<div class="pane-item field">
						<label for="template">Entry Template</label>
						<div class="input-wrapper"><input id="template" name="template" class="{if section.errors.template}error{/if}" type="text" value="{:section.template}" /></div>
					</div>
				</div>
				<div class="pane-item field">
					<label for="max_entries">Max Entries</label>
					<input id="max_entries" name="max_entries" class="input {if section.errors.max_entries}error{/if}" type="number" value="{:section.max_entries}" size="5" />
					{if section.errors.max_entries}
						{include "_includes/error_list" errors=section.errors.max_entries}
					{/if}
				</div>
			</div>
		</div>

		<div class="pane">
			<div class="pane-head">
				<h5>Section Content Blocks</h5>
			</div>
			{include "_includes/blockeditor" name="blocks" currentBlocks=section.blocks}
		</div>

		<div><input class="btn big submit" type="submit" value="Save Section" /></div>
	</form>
{/region}

{region "scripts"}
	<script type="text/javascript">
		{if !section.handle}new b.ui.HandleGenerator('#name', '#handle');{/if}
		{if !section.url_format}new b.ui.EntryUrlFormatGenerator('#name', '#url_format');{/if}
	</script>
{/region}
