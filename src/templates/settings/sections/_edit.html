{% layout "settings/_layouts/settings" pageTitle="Edit Section" %}

{% if !section %}
	{% set section = content.getSection(sectionId) %}
{% endif %}

{% region "main" %}
	<div class="toolbar">
		{% include "_includes/back_btn" label="Content Sections" uri="settings/sections" %}
	</div>

	<form method="post" action="">
		<input type="hidden" name="action" value="content/saveSection" />
		<input type="hidden" name="redirect" value="settings/sections" />
		{% if section.id %}<input type="hidden" name="section_id" value="{section.id}">{% endif %}
		<div class="pane">
			<div class="head">
				{% if section.id %}
					<h5>Edit Section {% if section.name %}“{section.name}”{% endif %}</h5>
				{% else %}
					<h5>Create a new section</h5>
				{% endif %}
			</div>
			<div class="body">
				<div class="item field">
					<label class="required" for="name">Section Name</label>
					<div class="input-wrapper"><input id="name" name="name" class="{% if section.errors.name %}error{% endif %}" type="text" value="{section.name}" /></div>
					{% if section.errors.name %}
						{% include "_includes/error_list" errors=section.errors.name %}
					{% endif %}
				</div>
				<div class="item field">
					<label class="required" for="handle">Section Handle</label>
					<p>This is how you’ll refer to your section from your templates.</p>
					<div class="input-wrapper"><input id="handle" name="handle" class="code {% if section.errors.handle %}error{% endif %}" type="text" value="{section.handle}" /></div>
					{% if section.errors.handle %}
						{% include "_includes/error_list" errors=section.errors.handle %}
					{% endif %}
				</div>
				<div class="item field">
					<label for="max_entries">Max Entries</label>
					<p>If you want to limit the number of entries this section can have, enter it here.</p>
					<input id="max_entries" name="max_entries" class="input {% if section.errors.max_entries %}error{% endif %}" type="number" value="{section.max_entries}" size="5" />
					{% if section.errors.max_entries %}
						{% include "_includes/error_list" errors=section.errors.max_entries %}
					{% endif %}
				</div>
				<div class="item field">
					<label for="sortable">Are entries sortable?</label>
					<p>Do entries in this section have a sortable display order?</p>
					{% include "_includes/lightswitch" name="sortable" on=section.sortable %}
					{% if section.errors.sortable %}
						{% include "_includes/error_list" errors=section.errors.sortable %}
					{% endif %}
				</div>
				<div class="item">
					<div class="field">
						<label for="has_urls">Do entries have URLs?</label>
						<p>Can you access entries in this section directly via unique URLs?</p>
						{% include "_includes/lightswitch" name="has_urls" on=section.has_urls toggle="#has-urls-setting" %}

						<div id="has-urls-setting" class="nested" {% if !section.has_urls %}style="display: none"{% endif %}>
							<div class="field">
								<label for="url_format">Entry URL Format</label>
								<p>If entries in this section get their own URLs on your website, define the format of their URLs here.</p>
								<div class="input-wrapper"><input id="url_format" name="url_format" class="code {% if section.errors.url_format %}error{% endif %}" type="text" value="{section.url_format}" /></div>
							</div>
							<div class="field">
								<label for="template">Entry Template</label>
								<p>Which template should be used to display entries in this section?</p>
								<div class="input-wrapper"><input id="template" name="template" class="{% if section.errors.template %}error{% endif %}" type="text" value="{section.template}" /></div>
							</div>
						</div>
					</div>
				</div>
				<div class="item field">
					<label for="blocks">Content Blocks</label>
					<p>Which content blocks should be present when editing an entry in this section?</p>
					{% include "_includes/blocksselect/field" selectedBlocks=section.blocks name="blocks" %}
				</div>
			</div>
		</div>

		<div><input class="btn big submit" type="submit" value="Save Section" /></div>
	</form>
{% endregion %}

{% region "scripts" %}
	<script type="text/javascript">
		{% if !section.handle %}new blx.ui.HandleGenerator('#name', '#handle');{% endif %}
		{% if !section.url_format %}new blx.ui.EntryUrlFormatGenerator('#name', '#url_format');{% endif %}
	</script>
{% endregion %}
