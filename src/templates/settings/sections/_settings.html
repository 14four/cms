{% if not section and sectionId %}
	{% set section = blx.content.getSectionById(sectionId) %}
	{% if not section %}{% exit 404 %}{% endif %}
{% endif %}


{% extends "_layouts/cp" %}


{% if section.id %}
	{% set title = "{name} Settings"|t({ 'name': section.name|t }) %}
{% else %}
	{% set title = "Create a new section"|t %}
{% endif %}


{% set titlebar %}
	<h1>{{ title }}</h1>
	<ul class="left">
		<li><a href="{{ url('settings/sections') }}" class="btn backbtn">{{ "Sections"|t }}</a></li>
	</ul>
{% endset %}


{% set content %}
	<form method="post" action="" class="centered">
		<input type="hidden" name="action" value="content/saveSection">
		<input type="hidden" name="redirect" value="settings/sections">
		{% if section.id %}<input type="hidden" name="sectionId" value="{{ section.id }}">{% endif %}

		<div class="field first">
			<div class="heading">
				<label class="required" for="name">
					{{ "Name"|t }}
					{% if blx.language != blx.app.language %}{{ "(in {language})"|t({ 'language': blx.localization.localeName(blx.app.language) }) }}{% endif %}
				</label>
				<p>{{ "What this section will be called in the CP."|t }}</p>
			</div>
			<div class="textwrapper"><input id="name" name="name" class="text {% if section.errors.name %}error{% endif %}" type="text" value="{{ section.name }}"></div>
			{% if section.errors.name %}
				{% include "_includes/error_list" with {'errors': section.errors.name} %}
			{% endif %}
		</div>

		<div class="field">
			<div class="heading">
				<label class="required" for="handle">{{ "Handle"|t }}</label>
				<p>{{ "How you’ll refer to this section in the templates."|t }}</p>
			</div>
			<div class="textwrapper"><input id="handle" name="handle" class="text code {% if section.errors.handle %}error{% endif %}" type="text" value="{{ section.handle }}"></div>
			{% if section.errors.handle %}
				{% include "_includes/error_list" with {'errors': section.errors.handle} %}
			{% endif %}
		</div>

		<hr>

		<div class="field checkbox">
			<label>
				<input type="checkbox" name="has_urls" value="y" {% if section.has_urls %}checked{% endif %} class="fieldtoggle" data-target="has-urls-setting">
				{{ "Entries in this section have their own URLs"|t }}
			</label>
		</div>

		<div id="has-urls-setting" class="nested-fields" {% if not section.has_urls %}style="height: 0"{% endif %}>
			<div class="field">
				<div class="heading">
					<label for="url_format">{{ "Entry URL Format"|t }}</label>
					<p>{{ "What the entry URLs should look like."|t }}</p>
				</div>
				<div class="textwrapper"><input id="url_format" name="url_format" class="text code" type="text" value="{{ section.url_format }}"></div>
			</div>

			<div class="field">
				<div class="heading">
					<label for="template">{{ "Entry Template"|t }}</label>
					<p>{{ "Which template to use when an entry’s URL is requested."|t }}</p>
				</div>
				<div class="textwrapper"><input id="template" name="template" class="text" type="text" value="{{ section.template }}"></div>
			</div>
		</div>

		<hr>

		<div class="buttons">
			<input type="submit" class="btn submit" value="{{ 'Save'|t }}">
		</div>
	</form>
{% endset %}


{% set scripts %}
	<script type="text/javascript">
		{% if not section.handle %}new blx.ui.HandleGenerator('#name', '#handle');{% endif %}
		{% if not section.url_format %}new blx.ui.EntryUrlFormatGenerator('#name', '#url_format');{% endif %}
	</script>
{% endset %}
