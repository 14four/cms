{% layout "users/_layouts/users" pageTitle="Edit User" %}

{% if !theUser && userId %}
	{% set theUser = users.getById(userId) %}
{% endif %}

{% region "main" %}
	<div class="pane">
		<div class="head">
			{% if theUser.id %}
				<h5>Edit User {% if thetheUser.user_name %}“{{ thetheUser.user_name }}”{% endif %}</h5>
			{% else %}
				<h5>Register a new user</h5>
			{% endif %}
		</div>
		<div class="body">
			<form method="post" action="">
				<input type="hidden" name="action" value="app/users/edit" />
				<input type="hidden" name="redirect" value="users" />
				{% if theUser.id %}<input type="hidden" name="user_id" value="{{ theUser.id }}">{% endif %}

				<div class="item">
					<div class="field">
						<label for="username">Username</label>
						{% set userNameErrors = theUser.errors.username %}
						<div class="input-wrapper"><input id="username" name="user[username]" class="{% if userNameErrors %}error{% endif %}" type="text" value="{{ theUser.username }}" /></div>
						{% if userNameErrors %}
							{% include "_includes/error_list" errors=userNameErrors %}
						{% endif %}
					</div>
					<div class="field">
						<label for="first_name">First Name</label>
						{% set firstNameErrors = theUser.errors.first_name %}
						<div class="input-wrapper"><input id="first_name" name="user[first_name]" class="{% if firstNameErrors %}error{% endif %}" type="text" value="{{ theUser.first_name }}" /></div>
						{% if firstNameErrors %}
							{% include "_includes/error_list" errors=firstNameErrors %}
						{% endif %}
					</div>
					<div class="field">
						<label for="last_name">Last Name</label>
						{% set lastNameErrors = theUser.errors.last_name %}
						<div class="input-wrapper"><input id="last_name" name="user[last_name]" class="{% if lastNameErrors %}error{% endif %}" type="text" value="{{ theUser.last_name }}" /></div>
						{% if lastNameErrors %}
							{% include "_includes/error_list" errors=lastNameErrors %}
						{% endif %}
					</div>
					<div class="field">
						<label for="email">Email</label>
						{% set emailErrors = theUser.errors.email %}
						<div class="input-wrapper"><input id="email" name="user[email]" class="{% if emailErrors %}error{% endif %}" type="text" value="{{ theUser.email }}" /></div>
						{% if emailErrors %}
							{% include "_includes/error_list" errors=emailErrors %}
						{% endif %}
					</div>
					<div class="field">
						<label for="admin">Admin</label>
						<div class="input-wrapper"><input id="admin" name="user[admin]" type="checkbox" {% if theUser.admin %}checked{% endif %} /></div>
					</div>
					<div class="field">
						<label for="html_email">Html Emails</label>
						<div class="input-wrapper"><input id="html_email" name="user[html_email]" type="checkbox" {% if theUser.html_email %}checked{% endif %} /></div>
					</div>
					<div class="field">
						<label for="password_reset">Password Reset Required</label>
						<div class="input-wrapper"><input id="password_reset" name="user[password_reset]" type="checkbox" {% if theUser.password_reset_required %}checked{% endif %} /></div>
					</div>
					<div class="field">
						<div><b>Last Login Date:</b> {% if theUser.last_login_date %}theUser.last_login_date{% else %}Never{% endif %}</div>
					</div>
					<div class="field">
						<div><b>Last Password Changed Date:</b> {% if theUser.last_password_changed_date %}theUser.last_password_changed_date{% else %}Never{% endif %}</div>
					</div>
					<div class="field">
						<div><b>Last Lockout Date:</b> {% if theUser.last_lockout_date %}theUser.last_lockout_date{% else %}Never{% endif %}</div>
					</div>
					<div class="field">
						<div><b>Failed Password Attempt Count:</b> {% if theUser.failed_password_attempt_count %}theUser.failed_password_attempt_count{% else %}0{% endif %}</div>
					</div>

					<p />
					<input class="btn big submit" type="submit" value="Save User" />
				</div>
			</form>
		</div>
	</div>
{% endregion %}
