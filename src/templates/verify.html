{% if user.isloggedIn %}
	{% redirect "dashboard" %}
{% endif %}

{% layout "_layouts/basic" pageTitle="Verify Account" %}

{% region "body" %}
	<div class="pane">
		<div class="head">
			Set Password
		</div>
		<div class="body">
			<form method="post" action="">
				<input type="hidden" name="action" value="account/verify" />
				<input type="hidden" name="redirect" value="dashboard" />

				{% set activationCode = url.get('code') %}
				{% if activationCode && security.validateUserRegistration(activationCode) %}
					{% set userModel = security.getUserByActivationCode(activationCode) %}

					<div class="item">Let's set a password for your account.</div>
					<input type="hidden" name="userId" value="{userModel.id}" />
					<div class="item field">
						<div class="input-wrapper">
							<label for="password">Password</label>
							<input id="password" name="password" class="{% if verifyAccountInfo.errors.password %}error{% endif %}" type="password" />
						</div>
						{% if verifyAccountInfo.errors.password %}
							{% include "_includes/error_list" errors=verifyAccountInfo.errors.password %}
						{% endif %}
					</div>
					<div class="item field">
						<div class="input-wrapper">
							<label for="confirm-password">Confirm Password</label>
							<input id="confirm-password" name="confirm-password" class="{% if verifyAccountInfo.errors.confirmPassword %}error{% endif %}" type="password" />
						</div>
						{% if verifyAccountInfo.errors.confirmPassword %}
							{% include "_includes/error_list" errors=verifyAccountInfo.errors.confirmPassword %}
						{% endif %}
					</div>
					<div class="item">
						<input class="btn big submit" type="submit" value="Set Password" />
					</div>
				{% else %}
					There was a problem validating this activation code.
				{% endif %}
			</form>
		</div>
	</div>
{% endregion %}
