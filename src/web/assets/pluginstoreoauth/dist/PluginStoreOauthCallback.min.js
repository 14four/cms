!function(a){Craft.PluginStoreOauthCallback=Garnish.Base.extend({$graphic:null,$status:null,errorDetails:null,data:null,init:function(){this.$graphic=a("#graphic"),this.$status=a("#status"),setTimeout(a.proxy(function(){this.postActionRequest()},this),500)},postActionRequest:function(){var b=window.location.hash.substr(1),c=a.parseFragmentString(b);Craft.postActionRequest("plugin-store/save-token",c,a.proxy(function(b,c,d){"success"==c?b.error?this.showError(b.error):(this.updateStatus("<p>"+Craft.t("app","Connected!")+"</p>"),this.$graphic.addClass("success"),setTimeout(a.proxy(function(){window.location=Craft.getCpUrl("myaccount")},this),500)):this.showFatalError(d)},this))},showFatalError:function(a){this.$graphic.addClass("error");var b="<p>"+Craft.t("app","A fatal error has occurred:")+'</p><div id="error" class="code"><p><strong class="code">'+Craft.t("app","Status:")+"</strong> "+Craft.escapeHtml(a.statusText)+'</p><p><strong class="code">'+Craft.t("app","Response:")+"</strong> "+Craft.escapeHtml(a.responseText)+'</p></div><a class="btn submit big" href="mailto:support@craftcms.com?subject='+encodeURIComponent("Craft update failure")+"&body="+encodeURIComponent("Describe what happened here.\n\n-----------------------------------------------------------\n\nStatus: "+a.statusText+"\n\nResponse: "+a.responseText)+'">'+Craft.t("app","Send for help")+"</a>";this.updateStatus(b)},updateStatus:function(a){this.$status.html(a)},showError:function(b){this.$graphic.addClass("error"),this.updateStatus("<p>"+b+"</p>");var c=a('<div id="junction-buttons"/>').appendTo(this.$status);$cancelBtn=a("<a/>",{class:"btn big",href:Craft.getCpUrl("myaccount"),text:"Cancel"}).appendTo(c),$retryBtn=a("<a/>",{class:"btn big",href:Craft.getActionUrl("plugin-store/connect"),text:"Try again"}).appendTo(c)}})}(jQuery);
//# sourceMappingURL=PluginStoreOauthCallback.min.js.map